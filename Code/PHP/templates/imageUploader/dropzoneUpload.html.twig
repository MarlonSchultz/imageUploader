{% extends 'base.html.twig' %}
    {% block stylesheets %}
        {{ parent() }}
        <link href="{{ asset('css/dropzone.css') }}" rel="stylesheet"/>
    {% endblock %}
{% block title %}Upload picture!{% endblock %}

{% block body %}
    <form action="/file-upload" class="dropzone dz-clickable" id="my-dropzone">
        <div class="dz-message d-flex flex-column">
            <i class="fas fa-cloud-upload-alt"></i>
            Drag &amp; Drop here or click
        </div>
    </form>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/dropzone.js') }}"></script>
    <script>
        // init,configure dropzone
        Dropzone.autoDiscover = false;
        var dropzone_default = new Dropzone(".dropzone", {
            url: '{{ path('xhr_upload') }}' ,
            maxFiles: 1,
            dictMaxFilesExceeded: 'Only 1 Image can be uploaded',
            acceptedFiles: 'image/*',
            maxFilesize: 3,  // in Mb
            addRemoveLinks: true,
            init: function () {
                this.on("maxfilesexceeded", function(file) {
                    this.removeFile(file);
                });
                this.on("sending", function(file, xhr, formData) {
                    // send additional data with the file as POST data if needed.
                    // formData.append("key", "value");
                });
                this.on("success", function(file, response) {
                    if (response.uploaded)
                        alert('File Uploaded: ' + response.fileName);
                });
            }
        });
    </script>
{% endblock %}
